# üììStruct - Unionüìì

<details>
<summary><b>üìñ1. Struct</b></summary>

### 1.1. Kh√°i ni·ªám
- **Struct:** l√† m·ªôt c·∫•u tr√∫c d·ªØ li·ªáu cho ph√©p l·∫≠p tr√¨nh vi√™n t·ª± ƒë·ªãnh nghƒ©a m·ªôt ki·ªÉu d·ªØ li·ªáu m·ªõi b·∫±ng c√°ch nh√≥m c√°c bi·∫øn c√≥ c√°c ki·ªÉu d·ªØ li·ªáu kh√°c nhau l·∫°i v·ªõi nhau
### 1.2. C√∫ ph√°p
- **Khai b√°o t∆∞·ªùng m√¨nh**.<br>
```c
struct name_struct
{
   <data type 1> <member 1>;
   <data type 2> <member 2>;
    // ...
};
```
- **Khai b√°o kh√¥ng t∆∞·ªùng m√¨nh**.<br>

```c
typdef struct 
{
   <data type 1> <member 1>;
   <data type 2> <member 2>;
    // ...
}name_struct;
```
- **V√≠ d·ª•:** <br>

&nbsp;+ Khai b√°o t∆∞·ªùng m√¨nh.<br>
```c
struct User
{
   char *name;
   int age;
   char *addr;
};
struct User user1, user2, *user3;
```
&nbsp;+ Khai b√°o kh√¥ng t∆∞·ªùng m√¨nh.<br>
```c
typdef struct 
{
   char *name;
   int age;
   char *addr;
} User;
User user1, user2, *user3;
```
### 1.3. Truy xu·∫•t d·ªØ li·ªáu
- S·ª≠ d·ª•ng ".": To√°n t·ª≠ truy xu·∫•t t·ªõi th√†nh vi√™n khi khai b√°o bi·∫øn b√¨nh th∆∞·ªùng.<br>
- S·ª≠ d·ª•ng "->": To√°n t·ª≠ truy xu·∫•t t·ªõi th√†nh vi√™n khi khai b√°o bi·∫øn l√† con tr·ªè.<br>
&nbsp;+ V√≠ d·ª•:<br>
```c
user1,name = "Hieu";
user3->name = "Hieu";
```
### 1.4. K√≠ch th∆∞·ªõc c·ªßa struct
- **Data Alignment:** l√† qu√° tr√¨nh s·∫Øp x·∫øp bi·∫øn th√†nh vi√™n c·ªßa struct sao cho c√°c bi·∫øn n·∫±m ·ªü ƒë·ªãa ch·ªâ ph√π h·ª£p v·ªõi y√™u c·∫ßu cƒÉn ch·ªânh c·ªßa CPU. N√≥ s·∫Ω s·∫Øp x·∫øp sao cho ƒë·ªãa ch·ªâ c√°c bi·∫øn l√† s·ªë ch·∫µn v√† ph√π h·ª£p v·ªõi h·ªá th·ªëng
- **Data padding:** L√† byte d·ªØ li·ªáu tr·ªëng 
- **K√≠ch th∆∞·ªõc Struct:** l√† b·ªôi k√≠ch th∆∞·ªõc c·ªßa ph·∫ßn t·ª≠ c√≥ k√≠ch th∆∞·ªõc l·ªõn nh·∫•t
- V√≠ d·ª•:<br>
```c
typdef struct 
{  // c·∫•p ph√°t theo th√†nh vi√™n l·ªõn nh·∫•t l√† char* addr ( k√≠ch th∆∞·ªõc con tr·ªè ph·ª• thu·ªôc v√†o ki·∫øn tr√∫c c·ªßa h·ªá th·ªëng: 32bit, 64bit)=> c·∫•p ph√°t 8byte
   char *name; // 0xa0, 0xa1, 0xa2, 0xa3 ( padding: 0xa1, 0xa2, 0xa3 )
   int age;    // 0xa4, 0xa5, 0xa6, 0xa7
   char *addr; // 0xa8, 0xa9, 0xaa, 0xab. 0xac, 0xad, 0xae, 0xaf
} User;
// c·∫•p ph√°t ƒë·ªãa ch·ªâ d·ª±a tr√™n k√≠ch th∆∞·ªõc member l·ªõn nh·∫•t
// 0xa0, 0xa1, 0xa2, 0xa3, 0xa4, 0xa5, 0xa6, 0xa7 (l·∫ßn 1)
// 0xa8, 0xa9, 0xaa, 0xab . 0xac, 0xad, 0xae, 0xaf (l·∫ßn 2)
//T·ªïng 16 byte
// d√πng: 13 byte
// d∆∞: 3 byte -> 3 padding
```
&nbsp;+ k√≠ch th∆∞·ªõc m·∫£ng struct:<br>
```c
struct Example1 
{
    uint8_t  arr1[5];
    uint16_t arr2[0];  
    uint16_t arr2[1]; 
    uint16_t arr2[2]; 
    uint16_t arr2[3];
    uint32_t arr3[2];
};
```
=> C·∫•p ph√°t b·ªô nh·ªõ:<br>
![image](https://github.com/user-attachments/assets/2864a73a-aa37-441e-9ca1-8e9d8f357079)
### 1.5. Bit Field
- **Bit Field:** l√† m·ªôt th√†nh ph·∫ßn ƒë·∫∑c bi·ªát c·ªßa c·∫•u tr√∫c (struct) cho ph√©p b·∫°n ch·ªâ ƒë·ªãnh s·ªë l∆∞·ª£ng bit c·ª• th·ªÉ d√πng ƒë·ªÉ l∆∞u tr·ªØ m·ªôt bi·∫øn s·ªë nguy√™n. Thay v√¨ s·ª≠ d·ª•ng to√†n b·ªô k√≠ch th∆∞·ªõc c·ªßa m·ªôt ki·ªÉu d·ªØ li·ªáu, b·∫°n c√≥ th·ªÉ ‚Äúc·∫Øt nh·ªè‚Äù b·ªô nh·ªõ theo s·ªë bit c·∫ßn thi·∫øt, gi√∫p ti·∫øt ki·ªám kh√¥ng gian b·ªô nh·ªõ v√† m√¥ t·∫£ ch√≠nh x√°c h∆°n √Ω nghƒ©a c·ªßa d·ªØ li·ªáu (v√≠ d·ª•: l∆∞u tr·∫°ng th√°i b·∫≠t/t·∫Øt ch·ªâ c·∫ßn 1 bit)
- C√∫ ph√°p:<br>

```c
struct name_struct 
{
  <data type 1> <member 1> : <number of bits>;
  <data type 2> <member 2> : <number of bits>;
  //...
};
```
- V√≠ d·ª•: <br>

```c
struct Example
{
   int32_t flag :1;  // s·ª≠ d·ª•ng 1 trong 32 bit
   int64_t count :4; // s·ª≠ d·ª•ng 4 trong 64 bit
};
```
- S·ªë bit ch·ªâ ƒë·ªãnh tr·ª±c ti·∫øp gi·ªõi h·∫°n ph·∫°m vi gi√° tr·ªã c√≥ th·ªÉ l∆∞u. V√≠ d·ª•: m·ªôt bit field khai b√°o v·ªõi : 3 c√≥ th·ªÉ l∆∞u c√°c gi√° tr·ªã t·ª´ 0 ƒë·∫øn 7 (ƒë·ªëi v·ªõi unsigned).
- Kh√¥ng th·ªÉ s·ª≠ d·ª•ng to√°n t·ª≠ l·∫•y ƒë·ªãa ch·ªâ (&) tr√™n  c√°c th√†nh vi√™n bit field.
- **Ch√∫ √Ω:**

&nbsp;+ Kh√¥ng d√πng cho ki·ªÉu float.<br>
&nbsp;+ Kh√¥ng th·ªÉ truy c·∫≠p ƒë·ªãa ch·ªâ.<br>
</details>
 
--------------------------------------------------------------------------------------------------------------------------------------------------------

<details>
<summary><b>üìñ2. Union</b></summary>

### 2.1. Kh√°i ni·ªám
- **Union:** l√† m·ªôt c·∫•u tr√∫c d·ªØ li·ªáu gi√∫p l·∫≠p tr√¨nh vi√™n k·∫øt h·ª£p nhi·ªÅu ki·ªÉu d·ªØ li·ªáu kh√°c nhau v√†o c√πng m·ªôt v√πng nh·ªõ.
- **Union** gi√∫p ti·∫øt ki·ªám b·ªô nh·ªõ b·∫±ng c√°ch chia s·∫ª c√πng m·ªôt v√πng nh·ªõ cho c√°c th√†nh vi√™n c·ªßa n√≥. ƒêi·ªÅu n√†y c√≥ nghƒ©a l√†, trong m·ªôt th·ªùi ƒëi·ªÉm, ch·ªâ m·ªôt th√†nh vi√™n c·ªßa union c√≥ th·ªÉ ƒë∆∞·ª£c s·ª≠ d·ª•ng.
### 2.2. C√∫ ph√°p
- **Khai b√°o t∆∞·ªùng m√¨nh**.<br>
```c
union name_union
{
   <data type 1> <member 1>;
   <data type 2> <member 2>;
    // ...
};
```
- **Khai b√°o kh√¥ng t∆∞·ªùng m√¨nh**.<br>
```c
typdef union 
{
   <data type 1> <member 1>;
   <data type 2> <member 2>;
    // ...
}name_union;
```
- **V√≠ d·ª•:** <br>

&nbsp;+ Khai b√°o t∆∞·ªùng m√¨nh.<br>
```c
union Data 
{
   uint8_t  arr1[5];
   uint16_t arr2[9];
   uint32_t arr3[3];
};
union Data data1, data2, *data3;
```
&nbsp;+ Khai b√°o kh√¥ng t∆∞·ªùng m√¨nh.<br>
```c
typdef union 
{
   uint8_t  arr1[5];
   uint16_t arr2[9];
   uint32_t arr3[3];
} Data;
Data data1, data2, *data3;
```
### 2.3. K√≠ch th∆∞·ªõc Union
- Trong union, t·∫•t c·∫£ c√°c th√†nh vi√™n c√πng chia s·∫ª m·ªôt v√πng nh·ªõ.
- K√≠ch th∆∞·ªõc c·ªßa union s·∫Ω b·∫±ng v·ªõi k√≠ch th∆∞·ªõc c·ªßa th√†nh vi√™n l·ªõn nh·∫•t + padding.
- Ch·ªâ m·ªôt th√†nh vi√™n l∆∞u tr·ªØ gi√° tr·ªã t·∫°i m·ªôt th·ªùi ƒëi·ªÉm n·∫øu kh√¥ng d·ªØ li·ªáu s·∫Ω b·ªã ghi ƒë√®.
- V√≠ d·ª•: <br>
```c
union Data 
{
  uint8_t a1[5]; // 5 byte
  uint8_t a2[3]; // 3 byte
  uint8_t a3[6]; // 6 byte
};
```
=> C·∫•p ph√°t b·ªô nh·ªõ:<br>
![image](https://github.com/user-attachments/assets/7f4ea88c-cbfb-4cae-beea-407f459280bd)

### 2.5. So s√°nh Union - Struct
- Gi·ªëng:<br>
&nbsp;+ l√† ki·ªÉu d·ªØ li·ªáu t·ª± ƒë·ªãnh nghƒ©a.<br>
&nbsp;+ c√°ch truy xu·∫•t d·ªØ li·ªáu. <br>
- Kh√°c:
  ||Struct|Union|
  |:------------------------:|:------------------------:|:------------------------:|
  |K√≠ch th∆∞·ªõc|T·ªïng k√≠ch th∆∞·ªõc th√†nh vi√™n + Padding|T·ªïng c·ªßa th√†nh vi√™n l·ªõn nh·∫•t + padding|
  |V√πng nh·ªõ - memory|M·ªói th√†nh vi√™n ƒë·ªÅu c√≥ v√πng nh·ªõ ri√™ng|D√πng chung v√πng nh·ªõ|
  |Truy xu·∫•t v√πng nh·ªõ|Kh√¥ng ·∫£nh h∆∞·ªüng khi bi·∫øn th√†nh vi√™n thay ƒë·ªïi|·∫¢nh h∆∞·ªüng khi bi·∫øn th√†nh vi√™n thay ƒë·ªïi|
  
</details>

-----------------------------------------------------------------------------------------------------------------------------------------------
